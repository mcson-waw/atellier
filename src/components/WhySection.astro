---
/**
 * Why Section Component
 * Displays pain points and introduction text
 */
import { getCollection } from 'astro:content';
import SectionWrapper from './SectionWrapper.astro';
import BlobAmbientBackground from './BlobAmbientBackground.astro';

const whyContent = await getCollection('why');
const content = whyContent[0];
const { Content } = await content.render();

const iconMap: Record<string, string> = {
  wave: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>`,
  unlink: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>`,
  battery: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 8h14a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4a2 2 0 012-2zm16 3h2m-6-1v2"/></svg>`,
  body: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>`,
  heart: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/></svg>`,
  leaf: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"/></svg>`,
};
---

<SectionWrapper id="dla-kogo" background={content.data.background} paddingSize="compact">
  <BlobAmbientBackground variant="light" intensity="subtle" />
  
  <div class="relative z-10 pt-8 md:pt-12">
    <!-- Section Header -->
    <div class="text-center mb-10" data-animate="fade-up">
      <h2 class="text-display md:text-display-lg text-forest-900 mb-4">
        {content.data.title}
      </h2>
    </div>

    <!-- Main content container with overlay sticker -->
    <div class="relative max-w-2xl mx-auto">
      
      <!-- Pain Points - Animated List (centered as before) -->
      {content.data.painPoints && (
        <div class="mb-10 lg:mb-0">
          <div class="space-y-4">
            {content.data.painPoints.map((point, index) => (
              <div 
                class="pain-point-item flex items-center gap-4 p-4 bg-white/60 backdrop-blur-sm rounded-xl border border-forest-100 hover:border-moss/50 hover:bg-white/80 transition-all duration-500 cursor-default group"
                style={`animation-delay: ${index * 100}ms`}
                data-animate="fade-up"
              >
                <div class="flex-shrink-0 w-10 h-10 rounded-full bg-forest-100 flex items-center justify-center text-forest-600 group-hover:bg-moss/20 transition-all duration-500 icon-glow">
                  <Fragment set:html={iconMap[point.icon || 'wave']} />
                </div>
                <p class="text-body text-forest-700 group-hover:text-forest-800 transition-colors duration-300">
                  {point.description}
                </p>
              </div>
            ))}
          </div>
        </div>
      )}

      <!-- CTA Sticker - overlaid on desktop, below on mobile -->
      <div 
        class="
          flex justify-center pt-6 pb-4
          lg:absolute lg:pt-0 lg:pb-0 lg:-right-[100px] xl:-right-[140px] lg:bottom-0 lg:translate-y-[calc(150%+400px)] lg:z-20
        " 
        data-animate="fade-up"
      >
        <a href="#kurs" class="group block transform -rotate-2 hover:rotate-0 transition-all duration-300 sticker-float">
          <div class="relative bg-cream/90 lg:bg-cream/85 backdrop-blur-sm rounded-2xl p-5 md:p-6 shadow-lg border border-forest-100 max-w-xs lg:hover:bg-cream/95 transition-colors">
            <!-- Pin decoration -->
            <div class="absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-moss rounded-full shadow-md"></div>
            
            <!-- Tape strips -->
            <div class="absolute -top-1 -left-2 w-6 h-2 bg-forest-100/60 rotate-[-15deg] rounded-sm"></div>
            <div class="absolute -top-1 -right-2 w-6 h-2 bg-forest-100/60 rotate-[15deg] rounded-sm"></div>
            
            <!-- Content -->
            <p class="text-sm text-forest-600 text-center mb-2 leading-relaxed">
              Jeśli choć jeden z tych punktów do Ciebie przemawia...
            </p>
            
            <p class="text-lg md:text-xl font-medium text-moss-dark text-center mb-2">
              jesteś w dobrym miejscu
            </p>
            
            <div class="flex items-center justify-center gap-1 text-forest-500 group-hover:text-moss transition-colors">
              <span class="text-xs">dowiedz się więcej</span>
              <svg class="w-3 h-3 group-hover:translate-y-0.5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3" />
              </svg>
            </div>
          </div>
        </a>
      </div>
      
    </div>
  </div>
</SectionWrapper>

<style>
  /* Pain point items - staggered entrance */
  .pain-point-item {
    opacity: 0;
    transform: translateY(20px);
    animation: slideIn 0.6s ease-out forwards;
  }
  
  @keyframes slideIn {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  /* Phosphorescent forest glow on icon hover */
  .icon-glow {
    position: relative;
    transition: all 0.5s ease;
  }
  
  .icon-glow::before {
    content: '';
    position: absolute;
    inset: -4px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(168, 194, 165, 0) 0%, rgba(168, 194, 165, 0) 100%);
    transition: all 0.5s ease;
    z-index: -1;
  }
  
  .group:hover .icon-glow::before {
    background: radial-gradient(circle, rgba(168, 194, 165, 0.6) 0%, rgba(168, 194, 165, 0) 70%);
    inset: -8px;
    animation: phosphor-pulse 2s ease-in-out infinite;
  }
  
  .group:hover .icon-glow {
    color: #597A5B;
    filter: drop-shadow(0 0 8px rgba(168, 194, 165, 0.8));
  }
  
  .group:hover .icon-glow svg {
    filter: drop-shadow(0 0 4px rgba(123, 163, 122, 0.9));
    animation: icon-float 3s ease-in-out infinite;
  }
  
  @keyframes phosphor-pulse {
    0%, 100% {
      opacity: 0.6;
      transform: scale(1);
    }
    50% {
      opacity: 1;
      transform: scale(1.1);
    }
  }
  
  @keyframes icon-float {
    0%, 100% {
      transform: translateY(0) rotate(0deg);
    }
    25% {
      transform: translateY(-2px) rotate(3deg);
    }
    75% {
      transform: translateY(1px) rotate(-2deg);
    }
  }
  
  /* Sticker floating animation */
  .sticker-float {
    animation: sticker-gentle 6s ease-in-out infinite;
  }
  
  @keyframes sticker-gentle {
    0%, 100% {
      transform: rotate(-2deg) translateY(0);
    }
    50% {
      transform: rotate(-1deg) translateY(-4px);
    }
  }
  
  .sticker-float:hover {
    animation-play-state: paused;
  }
</style>


